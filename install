#!/usr/bin/env bash
set -e

APP_NAME="BarOs"
REPO="gabex47/BarOs"
INSTALL_DIR="/Applications"
TMP_DIR="/tmp/$APP_NAME"

echo "Installing $APP_NAME..."

mkdir -p "$TMP_DIR"

echo "Downloading latest release..."
curl -L -o "$TMP_DIR/$APP_NAME.zip" \
"https://github.com/$REPO/releases/latest/download/$APP_NAME.zip"

echo "Unzipping..."
unzip -o "$TMP_DIR/$APP_NAME.zip" -d "$TMP_DIR"

echo "Removing macOS quarantine..."
xattr -dr com.apple.quarantine "$TMP_DIR/$APP_NAME.app" || true

echo "Installing to Applications..."
rm -rf "$INSTALL_DIR/$APP_NAME.app"
mv "$TMP_DIR/$APP_NAME.app" "$INSTALL_DIR/"

echo "Cleaning temp files..."
rm -rf "$TMP_DIR"

echo "BarOs installed successfully ðŸš€"
open "$INSTALL_DIR/$APP_NAME.app"
